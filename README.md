# Epic

![](misc/images/raw_img_vs_all_tracked_cells.png?raw=true "Epic Cell Detection and Tracking")

Repository for software detailed in 'Fast AI-Enabled Cell Tracking and Migration Analysis for High-Throughput Drug Screening' research paper. See Abstract [below](#research-paper-abstract) for more details.

## Preliminary Information

Epic can be installed on popular operating systems such as Linux and Windows. We recommend using a GPU-enabled system for fast runtimes. Epic can also concurrently perform object tracking and analysis report generation for multiple image series.

## Installation

We recommend installing and running Epic within a virtual environment.

Tested on Windows 10 using Python 3.7 and miniconda3.

### Pre-requisites

1. Download and install [miniconda3](https://docs.conda.io/en/latest/miniconda.html), [Git](https://git-scm.com/downloads), [cmake](https://cmake.org/download/) and [Microsoft Visual studio 16 2019](https://visualstudio.microsoft.com/downloads/) for your system.

### Installing Epic
1. Launch 'Anaconda Prompt (miniconda3)'. The proceeding commands will be entered into this window.

2. Create a virtual environment with Python 3.7 and pywin32 preinstalled called 'epic_env':

    ```conda create -n epic_env python=3.7 pywin32```

3. Activate the environment:

   ```conda activate epic_env```


4. Clone this repository into your desired directory:

   ```git clone https://github.com/AlphonsGwatimba/Fast-AI-Enabled-Cell-Tracking-and-Migration-Analysis-for-High-Throughput-Drug-Screening.git```

5. Navigate into the cloned directory:

    ```cd Fast-AI-Enabled-Cell-Tracking-and-Migration-Analysis-for-High-Throughput-Drug-Screening```

6. Install Epic:

   ```python setup.py install```

- Note:  Virtual environment can be deactivated using:

   ```conda deactivate epic_env```

## Usage

Epic is a command line application. Enter `epic --help` within the `epic_env` environment for details on how to run Epic and its available commands.
## Additional Information

### Configuration File

Various ```epic``` commands require a configuration file. A base config file that can be modified is provided [here](misc/configs/config.yaml).

### Object Detection

Epic's default object detector is a [Luminioth](https://github.com/tryolabs/luminoth) implementation of [Faster R-CNN](https://arxiv.org/abs/1506.01497). The models provided [here](epic/detection/models/luminoth/checkpoints) have been trained for airway epithielal cell detection as in the paper. To retrain the current detector, for example to detect other object classes, please follow Luminoth's [guide](https://luminoth.readthedocs.io/en/latest/usage/training.html) and specify the generated model checkpoint IDs in the config.

Additionally, the current detector can be easily replaced with any other object detector or segmenter by writing a custom detector class that implements the [base_detector](epic/detection/base_detector.py) interface ([luminoth_detector](epic/detection/luminoth_detector.py) is an example of that).

### Object Tracking

The current appearance and motion features used for object tracking can be easily replaced with other features by writing a custom feature class that implements the [base_feature](epic/features/base_feature.py) interface (the classes in [appearance_features](epic/features/appearance_features.py) and [motion_features](epic/features/motion_features.py) is an example of that).

The current object tracker can also be easily replaced with any other object tracking algorithm by writing a custom tracker class that implements the [base_tracker](epic/detection/base_detector.py) interface ([epic_tracker](epic/detection/luminoth_detector.py) is an example of that).
### Analysis

Epic can automatically generate an analysis report after performing object tracking in an image series. A base report file for cell migration analysis that can be modified is provided [here](misc/notebooks/report.ipynb) as a Jupyter notebook. The path of a Jupyter notebook needs to specified in the config for automatic report generation.



## Examples

Example wound repair image series are provided [here](examples/). The cell detection, tracking, and analysis report output files generated by Epic are also provided. Examples of some of the generated images can be seen below.

### Raw Image Series

<img src="misc/images/raw_img_series.gif"/>


### Automatically Detected Leading Edges

<img src="misc/images/leading_edges.png" width="443"/>

### Cell Detections

<img src="misc/images/all_detections.gif"/>

### Cell Tracks

<img src="misc/images/all_tracks.gif"/>

## License

[MIT License](LICENSE)

## Acknowledgements

- https://github.com/bochinski/iou-tracker
- https://github.com/chinue/Fast-SSIM
- https://github.com/tryolabs/luminoth

## Research Paper <a name="research-paper-abstract"></a>

### Title
Fast AI-Enabled Cell Tracking and Migration Analysis for High-Throughput Drug Screening

### Abstract
To be released

### Access
To be released

## Our Team
[Learn more](https://walyanrespiratory.telethonkids.org.au/our-research/focus-areas/artifical-intelligence/)
